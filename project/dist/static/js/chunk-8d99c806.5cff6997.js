(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8d99c806"],{6316:function(t,s,e){t.exports=e.p+"static/img/ai_avatar.3b90aba1.png"},a42c:function(t,s,e){"use strict";e("a8ed")},a8ed:function(t,s,e){},e9e0:function(t,s,e){"use strict";e.r(s);var i=function(){var t=this,s=t._self._c;return s("div",{attrs:{id:"answer"}},[t.modelStatus?s("div",{staticClass:"container"},[t.isTipsClose?t._e():s("div",{staticClass:"tips"},[s("div",{staticClass:"tips-content"},[t._v("\n        在输入框中输入问题提交后，智能AI会根据您的问题进行回答。\n        "),s("br"),t._v("\n        当前AI回复长度限制为"+t._s(t.MAX_TOKENS_SIZE)+"。\n      ")]),s("div",{staticClass:"tips-close"},[s("el-checkbox",{attrs:{label:"不再提示"},model:{value:t.isNoPrompts,callback:function(s){t.isNoPrompts=s},expression:"isNoPrompts"}}),s("i",{staticClass:"el-icon-close",on:{click:function(s){return t.closeTips()}}})],1)]),s("div",{staticClass:"main"},[s("div",{staticClass:"in"},[s("el-input",{staticClass:"input-with-select",attrs:{placeholder:"当前AI模型提供的回答可能存在误差，一切问题以实际为主!"},nativeOn:{keydown:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:t.submitProblem()}},model:{value:t.searchTxt,callback:function(s){t.searchTxt=s},expression:"searchTxt"}},[s("el-button",{attrs:{slot:"append",icon:"el-icon-position"},on:{click:function(s){return t.submitProblem()}},slot:"append"})],1)],1),s("div",{ref:"prompts",staticClass:"prompts"},[t._l(t.prompts,(function(e,i){return s("div",{key:i,staticClass:"prompt",style:{background:"USER"==e.identity?"#fff":"rgba(64, 158, 255,0.1)"}},[s("div",{staticClass:"prompt-avatar"},[s("img",{directives:[{name:"show",rawName:"v-show",value:"USER"==e.identity,expression:"item.identity == 'USER'"}],staticStyle:{"border-radius":"50%"},attrs:{src:t.$store.state.loginCredentials.avatar,alt:"",srcset:""}}),s("img",{directives:[{name:"show",rawName:"v-show",value:"AI"==e.identity,expression:"item.identity == 'AI'"}],attrs:{src:t.aiAvatar,alt:"",srcset:""}})]),s("div",{staticClass:"prompt-content",domProps:{innerHTML:t._s(e.content)}})])})),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isAILoad,expression:"isAILoad"}],staticClass:"prompt-load",staticStyle:{background:"rgba(64, 158, 255, 0.1)"}},[s("div",{staticClass:"prompt-avatar"},[s("img",{attrs:{src:t.aiAvatar,alt:"",srcset:""}})]),t._m(0)])],2)])]):s("div",{staticClass:"model-error"},[t._v("\n    AI模型出错！请稍后再试!\n    "),s("br"),t._v("\n    正在检查服务器 "),s("span",[t._v(t._s(t.dynamicDot))])])])},a=[function(){var t=this,s=t._self._c;return s("div",{staticClass:"prompt-content"},[s("i",{staticClass:"el-icon-loading"})])}],n=(e("96cf"),e("1da1")),o=e("6316"),r=e.n(o),c={data:function(){return{baseUrl:this.$store.state.baseUrl,MAX_TOKENS_SIZE:2e3,dynamicDot:".",modelList:[],modelStatus:!0,isTipsClose:!1,isNoPrompts:!1,searchTxt:"",currentModel:"",prompts:[],aiAvatar:r.a,isAILoad:!1,configs:{}}},methods:{closeTips:function(){this.isTipsClose=!0,console.log("isNoPrompts",this.isNoPrompts),this.isNoPrompts&&localStorage.setItem("ANSWER_TIPS_STATUS",1)},checkTipsClose:function(){var t=localStorage.getItem("ANSWER_TIPS_STATUS");this.isTipsClose=!!t,console.log("closeStatus",!!t)},submitProblem:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var s,e,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(s=this.searchTxt,!this.isAILoad){t.next=4;break}return this.$message.error("请等待AI回答完上一个问题。"),t.abrupt("return");case 4:return this.searchTxt="",this.prompts.push({content:s,identity:"USER"}),this.isAILoad=!0,this.$nextTick((function(){i.$refs.prompts.scrollTop=i.$refs.prompts.scrollHeight})),this.searchTxt="",t.prev=9,t.next=12,this.axios.post("https://api.openai.com/v1/completions",{model:this.configs.openai_model,prompt:s,max_tokens:this.configs.openai_max_token_size,temperature:0},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.configs.openao_sdk)}});case 12:e=t.sent,this.isAILoad=!1,this.prompts.push({content:e.data.choices[0].text,identity:"AI"}),t.next=20;break;case 17:t.prev=17,t.t0=t["catch"](9),"invalid_api_key"==t.t0.response.data.error.code&&this.$message.error("当前Key已失效，请联系管理员后重试！");case 20:case"end":return t.stop()}}),t,this,[[9,17]])})));function s(){return t.apply(this,arguments)}return s}(),checkLogin:function(){var t=this.$store.state.loginCredentials.status;t||this.$router.push("/login")},getConfig:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.axios.get("".concat(this.baseUrl,"/config/openai/get"));case 2:s=t.sent,console.log("res -> ",s),this.configs=s.data;case 5:case"end":return t.stop()}}),t,this)})));function s(){return t.apply(this,arguments)}return s}(),init:function(){this.getConfig(),this.checkLogin(),this.checkTipsClose()}},mounted:function(){var t=this;this.init(),setInterval((function(){t.dynamicDot=t.dynamicDot+".",5==t.dynamicDot.length&&(t.dynamicDot=".")}),500)}},l=c,p=(e("a42c"),e("2877")),u=Object(p["a"])(l,i,a,!1,null,"2a03a6ee",null);s["default"]=u.exports}}]);
//# sourceMappingURL=chunk-8d99c806.5cff6997.js.map