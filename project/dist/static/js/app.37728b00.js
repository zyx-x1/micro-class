(function(e){function t(t){for(var a,r,o=t[0],c=t[1],u=t[2],l=0,d=[];l<o.length;l++)r=o[l],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&d.push(s[r][0]),s[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);h&&h(t);while(d.length)d.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,r=1;r<n.length;r++){var o=n[r];0!==s[o]&&(a=!1)}a&&(i.splice(t--,1),e=c(c.s=n[0]))}return e}var a={},r={app:0},s={app:0},i=[];function o(e){return c.p+"static/js/"+({}[e]||e)+"."+{"chunk-05959688":"36f71467","chunk-277c3352":"22d33664","chunk-41c3f700":"7870a7d6","chunk-42ba8347":"8cdb8a70","chunk-439615f6":"0a5c7c68","chunk-4a6d343a":"2ceb4ca1","chunk-51f7b9e2":"f8dfd5d9","chunk-8a47f8ca":"874eb882","chunk-8d99c806":"5cff6997","chunk-ddf2d534":"2bd99cf2"}[e]+".js"}function c(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[],n={"chunk-05959688":1,"chunk-277c3352":1,"chunk-41c3f700":1,"chunk-42ba8347":1,"chunk-439615f6":1,"chunk-4a6d343a":1,"chunk-51f7b9e2":1,"chunk-8a47f8ca":1,"chunk-8d99c806":1,"chunk-ddf2d534":1};r[e]?t.push(r[e]):0!==r[e]&&n[e]&&t.push(r[e]=new Promise((function(t,n){for(var a="static/css/"+({}[e]||e)+"."+{"chunk-05959688":"6582a8bf","chunk-277c3352":"9c750bdb","chunk-41c3f700":"cb2df819","chunk-42ba8347":"3b0cf39e","chunk-439615f6":"289017ee","chunk-4a6d343a":"358030dc","chunk-51f7b9e2":"faaf0e5e","chunk-8a47f8ca":"ab658d93","chunk-8d99c806":"50d46fb7","chunk-ddf2d534":"dc9213f8"}[e]+".css",s=c.p+a,i=document.getElementsByTagName("link"),o=0;o<i.length;o++){var u=i[o],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===a||l===s))return t()}var d=document.getElementsByTagName("style");for(o=0;o<d.length;o++){u=d[o],l=u.getAttribute("data-href");if(l===a||l===s)return t()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=t,h.onerror=function(t){var a=t&&t.target&&t.target.src||s,i=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");i.code="CSS_CHUNK_LOAD_FAILED",i.request=a,delete r[e],h.parentNode.removeChild(h),n(i)},h.href=s;var f=document.getElementsByTagName("head")[0];f.appendChild(h)})).then((function(){r[e]=0})));var a=s[e];if(0!==a)if(a)t.push(a[2]);else{var i=new Promise((function(t,n){a=s[e]=[t,n]}));t.push(a[2]=i);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=o(e);var d=new Error;u=function(t){l.onerror=l.onload=null,clearTimeout(h);var n=s[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+a+": "+r+")",d.name="ChunkLoadError",d.type=a,d.request=r,n[1](d)}s[e]=void 0}};var h=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(t)},c.m=e,c.c=a,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(n,a,function(t){return e[t]}.bind(null,a));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="",c.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=t,u=u.slice();for(var d=0;d<u.length;d++)t(u[d]);var h=l;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var a=n("2b0e"),r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("div",{attrs:{id:"nav"}},[t("Nav")],1),t("router-view")],1)},s=[],i=(n("6b54"),n("28a5"),n("96cf"),n("1da1")),o=(n("386d"),function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"nav"}},[t("div",{staticClass:"nav"},[t("ul",{staticClass:"nav-items"},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入关键字",clearable:"",size:"small","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search.apply(null,arguments)}},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}}),t("li",{staticClass:"item-common"},[t("router-link",{attrs:{to:"/"},on:{mouseover:function(t){e.showUserOptions=!0}}},[t("i",{staticClass:"el-icon-house"}),e._v(" 首页\n        ")])],1),t("li",{staticClass:"item-common"},[t("router-link",{attrs:{to:"/message"}},[t("i",{staticClass:"el-icon-message",staticStyle:{position:"relative",top:"1.5px"}}),e._v("\n          消息\n\n          "),t("el-badge",{directives:[{name:"show",rawName:"v-show",value:e.loginCredentials,expression:"loginCredentials"}],staticClass:"item",staticStyle:{position:"relative",left:"-10px",top:"-5px"},attrs:{value:e.messageCount,max:99}})],1)],1),t("li",{staticClass:"item-common"},[t("router-link",{attrs:{to:"/answer"}},[t("i",{staticClass:"el-icon-magic-stick",staticStyle:{position:"relative",top:"1.5px"}}),e._v("\n          解惑\n        ")])],1),t("li",{staticClass:"item-common"},[t("router-link",{attrs:{to:"/usercenter?view=my_collection"}},[t("i",{staticClass:"el-icon-collection-tag",staticStyle:{position:"relative",top:"1.5px"}}),e._v("\n          收藏\n        ")])],1),this.loginCredentials?t("li",{staticClass:"avatar",on:{mouseover:function(t){e.showUserOptions=!0},mouseleave:function(t){e.showUserOptions=!1}}},[t("router-link",{staticStyle:{display:"flex","justify-content":"center","align-items":"center",height:"50px"},attrs:{to:"/usercenter"}},[t("img",{staticStyle:{"border-radius":"50%"},attrs:{src:this.avatar,alt:"",width:"40px"}})]),t("transition",{attrs:{name:"fade"}},[t("ul",{directives:[{name:"show",rawName:"v-show",value:e.showUserOptions,expression:"showUserOptions"}],staticClass:"user-items"},[t("li",{on:{click:function(t){return e.$router.push("/usercenter")}}},[e._v("个人中心")]),t("li",{on:{click:function(t){return e.logOut()}}},[e._v("退出登录")])])])],1):t("li",{staticClass:"item-common"},[t("router-link",{attrs:{to:"/login"}},[e._v("登录/注册")])],1),t("li",{staticClass:"item-common"},[t("router-link",{attrs:{to:"/upload"}},[t("i",{staticClass:"el-icon-upload2"}),e._v(" 投稿\n        ")])],1)],1)])])}),c=[],u={data:function(){return{baseUrl:this.$store.state.baseUrl,loginCredentials:this.$store.state.loginCredentials.status,avatar:this.$store.state.loginCredentials.avatar,showUserOptions:!1,searchText:"",messageCount:0}},methods:{checkStateLoginCredentials:function(){var e=this,t=setInterval((function(){e.avatar=e.$store.state.loginCredentials.avatar,e.loginCredentials=e.$store.state.loginCredentials.status,e.avatar&&clearInterval(t)}),50)},logOut:function(){localStorage.removeItem("username"),localStorage.removeItem("token"),this.$store.commit("setLoginCredentials",{status:!1,username:"",loginTime:null,email:"",usernameUpdateTime:null}),this.loginCredentials=!1,this.$message({type:"warn",message:"注销成功！"}),this.$router.push("/"),location.reload()},search:function(){this.$router.push("/search?search_txt=".concat(this.searchText))},getMessageCount:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.$store.state.loginCredentials.status){e.next=5;break}return e.next=3,this.axios.get("".concat(this.baseUrl,"/message/count"),{params:{user:this.$store.state.loginCredentials.email}});case 3:t=e.sent,"success"==t.data.status&&(this.messageCount=t.data.total);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getAvatar:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.axios.get("".concat(this.baseUrl,"/user/avatar/get?id=").concat(this.$store.state.loginCredentials.id));case 2:t=e.sent,"success"==t.data.status&&(this.avatar=t.data.data);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},mounted:function(){var e=this;this.checkStateLoginCredentials(),setTimeout((function(){e.getMessageCount()}),50);var t=this,n=new WebSocket(this.$store.state.webSocketUrl);n.onopen=function(){n.onmessage=function(e){var n=JSON.parse(e.data);console.log("ws message ->",e),"message update"==n.msg&&t.getMessageCount(),"avatar update"==n.msg&&t.getAvatar()}}}},l=u,d=(n("a5b0"),n("2877")),h=Object(d["a"])(l,o,c,!1,null,null,null),f=h.exports,p={data:function(){return{baseUrl:this.$store.state.baseUrl}},components:{Nav:f},methods:{checkLogin:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=localStorage.getItem("token"),t){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.axios.get("".concat(this.baseUrl,"/login/token/check"),{params:{token:t}});case 5:if(n=e.sent,console.log("APP res",n),"fail"!=n.status){e.next=13;break}return this.$message.error(n.msg),localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.setItem("loginCredentials",0),e.abrupt("return");case 13:this.$store.commit("setLoginCredentials",{status:!0,id:n.data.user.id,username:n.data.user.username,avatar:n.data.user.avatar,email:n.data.user.email,usernameUpdateTime:n.data.user.username_updatetime,loginTime:new Date,credits:n.data.user.credits}),console.log("APP this.$store.state.loginCredentials",this.$store.state.loginCredentials);case 15:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),sendVisitor:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=localStorage.getItem("visitorId"),this.$store.state.loginCredentials.status){e.next=12;break}if(t||this.$store.state.loginCredentials.status||this.setVisitorId(),n=new Date,n.setTime(new Date(parseInt(t.split("-")[1]))),a=this.isSameDay(new Date,n),a){e.next=10;break}return this.setVisitorId(),e.next=10,this.axios.post("".concat(this.baseUrl,"/visitor/send"),{date:new Date,visitor_type:"visitor",visitor_id:localStorage.getItem("visitorId")},{headers:{"Content-Type":"application/x-www-form-urlencoded"}});case 10:e.next=14;break;case 12:return e.next=14,this.axios.post("".concat(this.baseUrl,"/visitor/send"),{date:new Date,visitor_type:"user",user_id:this.$store.state.loginCredentials.id},{headers:{"Content-Type":"application/x-www-form-urlencoded"}});case 14:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),isSameDay:function(e,t){var n=e.getYear(),a=e.getMonth(),r=e.getDate(),s=t.getYear(),i=t.getMonth(),o=t.getDate();return n==s&&a==i&&r==o},setVisitorId:function(){var e=(1e4*Math.random()).toString(16).split(".")[1]+"-"+(new Date).getTime();localStorage.setItem("visitorId",e)}},created:function(){this.checkLogin()},watch:{$route:function(){console.log("route change"),this.sendVisitor()}}},m=p,g=(n("cf8b"),Object(d["a"])(m,r,s,!1,null,null,null)),v=g.exports,b=n("8c4f");a["default"].use(b["a"]);var k=b["a"].prototype.push;b["a"].prototype.push=function(e){return k.call(this,e).catch((function(e){return e}))};var w=new b["a"]({routes:[{path:"/",redirect:"index"},{path:"/index",name:"index",component:function(){return n.e("chunk-8a47f8ca").then(n.bind(null,"b30e"))}},{path:"/login",name:"login",component:function(){return n.e("chunk-05959688").then(n.bind(null,"7101"))}},{path:"/signup",name:"signup",component:function(){return n.e("chunk-51f7b9e2").then(n.bind(null,"cad4"))}},{path:"/forget",name:"forget",component:function(){return n.e("chunk-42ba8347").then(n.bind(null,"8641"))}},{path:"/usercenter",name:"usercenter",component:function(){return n.e("chunk-41c3f700").then(n.bind(null,"4acb"))}},{path:"/detail",name:"detail",component:function(){return n.e("chunk-439615f6").then(n.bind(null,"a782"))},children:[{path:"*",component:function(){return n.e("chunk-439615f6").then(n.bind(null,"a782"))}}]},{path:"/search",name:"search",component:function(){return n.e("chunk-277c3352").then(n.bind(null,"cb80"))}},{path:"/message",name:"message",component:function(){return n.e("chunk-4a6d343a").then(n.bind(null,"a502"))}},{path:"/upload",name:"upload",component:function(){return n.e("chunk-ddf2d534").then(n.bind(null,"315e"))}},{path:"/answer",name:"answer",component:function(){return n.e("chunk-8d99c806").then(n.bind(null,"e9e0"))}}]});w.afterEach((function(e,t,n){window.scrollTo(0,0)}));var C=w,y=(n("6c7b"),n("2f62"));a["default"].use(y["a"]);var x=new y["a"].Store({state:{baseUrl:"http://47.113.150.244:3000",webSocketUrl:"ws://47.113.150.244:8181",signinCreditsValue:5,loginCredentials:{status:!1,id:-1,username:"",loginTime:null,email:"",usernameUpdateTime:null,credits:0}},mutations:{setLoginCredentials:function(e,t){e.loginCredentials=t},starAnimeBackground:function(e,t){var n=t,a=n.getContext("2d"),r=n.width=window.innerWidth,s=n.height=window.innerHeight,i=217,o=[],c=0,u=1100,l=document.createElement("canvas"),d=l.getContext("2d");l.width=100,l.height=100;var h=l.width/2,f=d.createRadialGradient(h,h,0,h,h,h);function p(e,t){if(arguments.length<2&&(t=e,e=0),e>t){var n=t;t=e,e=n}return Math.floor(Math.random()*(t-e+1))+e}f.addColorStop(.025,"#CCC"),f.addColorStop(.1,"hsl("+i+", 61%, 33%)"),f.addColorStop(.25,"hsl("+i+", 64%, 6%)"),f.addColorStop(1,"transparent"),d.fillStyle=f,d.beginPath(),d.arc(h,h,h,0,2*Math.PI),d.fill();var m=function(e,t){var n=Math.max(e,t),a=Math.round(Math.sqrt(n*n+n*n));return a/2},g=function(){this.orbitRadius=p(m(r,s)),this.radius=p(60,this.orbitRadius)/10,this.orbitX=r/2,this.orbitY=s/2,this.timePassed=p(0,u),this.speed=p(this.orbitRadius)/8e4,this.alpha=p(2,10)/10,c++,o[c]=this};g.prototype.draw=function(){var e=Math.sin(this.timePassed)*this.orbitRadius+this.orbitX,t=Math.cos(this.timePassed)*this.orbitRadius+this.orbitY,n=p(10);1===n&&this.alpha>0?this.alpha-=.05:2===n&&this.alpha<1&&(this.alpha+=.05),a.globalAlpha=this.alpha,a.drawImage(l,e-this.radius/2,t-this.radius/2,this.radius,this.radius),this.timePassed+=this.speed};for(var v=0;v<u;v++)new g;var b=function e(){a.globalCompositeOperation="source-over",a.globalAlpha=.5,a.fillStyle="hsla("+i+", 64%, 6%, 2)",a.fillRect(0,0,r,s),a.globalCompositeOperation="lighter";for(var t=1,n=o.length;t<n;t++)o[t].draw();window.requestAnimationFrame(e)};b()}},actions:{}}),S=n("9483");Object(S["a"])("".concat("","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var O=n("5c96"),_=n.n(O),T=(n("0fae"),n("cee4")),$=n("130e");a["default"].config.productionTip=!1,a["default"].use(_.a),a["default"].use($["a"],T["a"]),new a["default"]({router:C,store:x,render:function(e){return e(v)}}).$mount("#app")},5740:function(e,t,n){},a5b0:function(e,t,n){"use strict";n("5740")},bf53:function(e,t,n){},cf8b:function(e,t,n){"use strict";n("bf53")}});
//# sourceMappingURL=app.37728b00.js.map