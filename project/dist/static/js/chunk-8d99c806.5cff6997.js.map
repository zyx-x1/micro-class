{"version":3,"sources":["webpack:///./static/images/ai_avatar.png","webpack:///./src/views/Answer/answer.vue?8d9b","webpack:///./src/views/Answer/answer.vue","webpack:///src/views/Answer/answer.vue","webpack:///./src/views/Answer/answer.vue?cd38","webpack:///./src/views/Answer/answer.vue?c7c4"],"names":["module","exports","render","_vm","this","_c","_self","attrs","modelStatus","staticClass","isTipsClose","_e","_v","_s","MAX_TOKENS_SIZE","model","value","isNoPrompts","callback","$$v","expression","on","$event","closeTips","nativeOn","type","indexOf","_k","keyCode","key","submitProblem","searchTxt","slot","ref","_l","prompts","item","index","style","background","identity","directives","name","rawName","staticStyle","$store","state","loginCredentials","avatar","aiAvatar","domProps","content","isAILoad","_m","dynamicDot","staticRenderFns","data","baseUrl","modelList","currentModel","configs","methods","console","localStorage","checkTipsClose","search_txt","prompt","max_tokens","temperature","headers","Authorization","res","checkLogin","getConfig","init","mounted","setInterval","component"],"mappings":"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","file":"static/js/chunk-8d99c806.5cff6997.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/img/ai_avatar.3b90aba1.png\";","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./answer.vue?vue&type=style&index=0&id=2a03a6ee&prod&lang=less&scoped=true&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{attrs:{\"id\":\"answer\"}},[(!_vm.modelStatus)?_c('div',{staticClass:\"model-error\"},[_vm._v(\"\\n    AI模型出错！请稍后再试!\\n    \"),_c('br'),_vm._v(\"\\n    正在检查服务器 \"),_c('span',[_vm._v(_vm._s(_vm.dynamicDot))])]):_c('div',{staticClass:\"container\"},[(!_vm.isTipsClose)?_c('div',{staticClass:\"tips\"},[_c('div',{staticClass:\"tips-content\"},[_vm._v(\"\\n        在输入框中输入问题提交后，智能AI会根据您的问题进行回答。\\n        \"),_c('br'),_vm._v(\"\\n        当前AI回复长度限制为\"+_vm._s(_vm.MAX_TOKENS_SIZE)+\"。\\n      \")]),_c('div',{staticClass:\"tips-close\"},[_c('el-checkbox',{attrs:{\"label\":\"不再提示\"},model:{value:(_vm.isNoPrompts),callback:function ($$v) {_vm.isNoPrompts=$$v},expression:\"isNoPrompts\"}}),_c('i',{staticClass:\"el-icon-close\",on:{\"click\":function($event){return _vm.closeTips()}}})],1)]):_vm._e(),_c('div',{staticClass:\"main\"},[_c('div',{staticClass:\"in\"},[_c('el-input',{staticClass:\"input-with-select\",attrs:{\"placeholder\":\"当前AI模型提供的回答可能存在误差，一切问题以实际为主!\"},nativeOn:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\"))return null;return _vm.submitProblem()}},model:{value:(_vm.searchTxt),callback:function ($$v) {_vm.searchTxt=$$v},expression:\"searchTxt\"}},[_c('el-button',{attrs:{\"slot\":\"append\",\"icon\":\"el-icon-position\"},on:{\"click\":function($event){return _vm.submitProblem()}},slot:\"append\"})],1)],1),_c('div',{ref:\"prompts\",staticClass:\"prompts\"},[_vm._l((_vm.prompts),function(item,index){return _c('div',{key:index,staticClass:\"prompt\",style:({\n            background:\n              item.identity == 'USER' ? '#fff' : 'rgba(64, 158, 255,0.1)',\n          })},[_c('div',{staticClass:\"prompt-avatar\"},[_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(item.identity == 'USER'),expression:\"item.identity == 'USER'\"}],staticStyle:{\"border-radius\":\"50%\"},attrs:{\"src\":_vm.$store.state.loginCredentials.avatar,\"alt\":\"\",\"srcset\":\"\"}}),_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(item.identity == 'AI'),expression:\"item.identity == 'AI'\"}],attrs:{\"src\":_vm.aiAvatar,\"alt\":\"\",\"srcset\":\"\"}})]),_c('div',{staticClass:\"prompt-content\",domProps:{\"innerHTML\":_vm._s(item.content)}})])}),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isAILoad),expression:\"isAILoad\"}],staticClass:\"prompt-load\",staticStyle:{\"background\":\"rgba(64, 158, 255, 0.1)\"}},[_c('div',{staticClass:\"prompt-avatar\"},[_c('img',{attrs:{\"src\":_vm.aiAvatar,\"alt\":\"\",\"srcset\":\"\"}})]),_vm._m(0)])],2)])])])\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"prompt-content\"},[_c('i',{staticClass:\"el-icon-loading\"})])\n}]\n\nexport { render, staticRenderFns }","<template>\n  <div id=\"answer\">\n    <div class=\"model-error\" v-if=\"!modelStatus\">\n      AI模型出错！请稍后再试!\n      <br />\n      正在检查服务器 <span>{{ dynamicDot }}</span>\n    </div>\n    <div class=\"container\" v-else>\n      <div class=\"tips\" v-if=\"!isTipsClose\">\n        <div class=\"tips-content\">\n          在输入框中输入问题提交后，智能AI会根据您的问题进行回答。\n          <br />\n          当前AI回复长度限制为{{ MAX_TOKENS_SIZE }}。\n        </div>\n        <div class=\"tips-close\">\n          <el-checkbox v-model=\"isNoPrompts\" label=\"不再提示\"></el-checkbox>\n          <i class=\"el-icon-close\" @click=\"closeTips()\"></i>\n        </div>\n      </div>\n      <div class=\"main\">\n        <div class=\"in\">\n          <el-input\n            placeholder=\"当前AI模型提供的回答可能存在误差，一切问题以实际为主!\"\n            v-model=\"searchTxt\"\n            class=\"input-with-select\"\n            @keydown.enter.native=\"submitProblem()\"\n          >\n            <el-button\n              slot=\"append\"\n              icon=\"el-icon-position\"\n              @click=\"submitProblem()\"\n            ></el-button>\n          </el-input>\n        </div>\n        <div class=\"prompts\" ref=\"prompts\">\n          <div\n            class=\"prompt\"\n            v-for=\"(item, index) in prompts\"\n            :key=\"index\"\n            :style=\"{\n              background:\n                item.identity == 'USER' ? '#fff' : 'rgba(64, 158, 255,0.1)',\n            }\"\n          >\n            <div class=\"prompt-avatar\">\n              <img\n                :src=\"$store.state.loginCredentials.avatar\"\n                v-show=\"item.identity == 'USER'\"\n                style=\"border-radius: 50%\"\n                alt=\"\"\n                srcset=\"\"\n              />\n              <img\n                :src=\"aiAvatar\"\n                v-show=\"item.identity == 'AI'\"\n                alt=\"\"\n                srcset=\"\"\n              />\n            </div>\n            <div class=\"prompt-content\" v-html=\"item.content\"></div>\n          </div>\n          <div\n            v-show=\"isAILoad\"\n            class=\"prompt-load\"\n            style=\"background: rgba(64, 158, 255, 0.1)\"\n          >\n            <div class=\"prompt-avatar\">\n              <img :src=\"aiAvatar\" alt=\"\" srcset=\"\" />\n            </div>\n            <div class=\"prompt-content\">\n              <i class=\"el-icon-loading\"></i>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n  \n<script>\nimport aiAvatar from \"../../../static/images/ai_avatar.png\";\nexport default {\n  data() {\n    return {\n      baseUrl: this.$store.state.baseUrl,\n      MAX_TOKENS_SIZE: 2000,\n      dynamicDot: \".\",\n      modelList: [],\n      modelStatus: true,\n      isTipsClose: false,\n      isNoPrompts: false,\n      searchTxt: \"\",\n      currentModel: \"\",\n      prompts: [],\n      aiAvatar: aiAvatar,\n      isAILoad: false,\n      configs: {},\n    };\n  },\n  methods: {\n    closeTips() {\n      this.isTipsClose = true;\n      console.log(`isNoPrompts`, this.isNoPrompts);\n      if (this.isNoPrompts) {\n        localStorage.setItem(\"ANSWER_TIPS_STATUS\", 1);\n      }\n    },\n    checkTipsClose() {\n      let closeStatus = localStorage.getItem(\"ANSWER_TIPS_STATUS\");\n      this.isTipsClose = !!closeStatus;\n      console.log(`closeStatus`, !!closeStatus);\n    },\n    async submitProblem() {\n      let search_txt = this.searchTxt;\n      if (this.isAILoad) {\n        this.$message.error(\"请等待AI回答完上一个问题。\");\n        return;\n      }\n      this.searchTxt = \"\";\n      this.prompts.push({\n        content: search_txt,\n        identity: \"USER\",\n      });\n      this.isAILoad = true;\n      this.$nextTick(() => {\n        this.$refs.prompts.scrollTop = this.$refs.prompts.scrollHeight;\n      });\n      this.searchTxt = \"\";\n      try {\n        let res = await this.axios.post(\n          \"https://api.openai.com/v1/completions\",\n          {\n            model: this.configs.openai_model,\n            prompt: search_txt,\n            max_tokens: this.configs.openai_max_token_size,\n            temperature: 0,\n          },\n          {\n            headers: {\n              \"Content-Type\": \"application/json\",\n              Authorization: `Bearer ${this.configs.openao_sdk}`,\n            },\n          }\n        );\n        this.isAILoad = false;\n        this.prompts.push({\n          content: res.data.choices[0].text,\n          identity: \"AI\",\n        });\n      } catch (e) {\n        if (e.response.data.error.code == \"invalid_api_key\") {\n          this.$message.error(\"当前Key已失效，请联系管理员后重试！\");\n        }\n      }\n    },\n    checkLogin() {\n      let status = this.$store.state.loginCredentials.status;\n      if (!status) this.$router.push(\"/login\");\n    },\n    async getConfig() {\n      let res = await this.axios.get(`${this.baseUrl}/config/openai/get`);\n      console.log(\"res -> \", res);\n      this.configs = res.data;\n    },\n    init() {\n      this.getConfig();\n      this.checkLogin();\n      this.checkTipsClose();\n    },\n  },\n  mounted() {\n    this.init();\n    setInterval(() => {\n      this.dynamicDot = this.dynamicDot + \".\";\n      if (this.dynamicDot.length == 5) {\n        this.dynamicDot = \".\";\n      }\n    }, 500);\n  },\n};\n</script>\n  \n<style lang=\"less\" scoped>\n*::-webkit-scrollbar {\n  width: 10px;\n  height: 1px;\n}\n\n#answer {\n  background-color: rgba(0, 0, 0, 0.1);\n  width: 100%;\n  height: calc(100% - 200px);\n  padding: 100px 0 60px;\n\n  .model-error {\n    font-size: 30px;\n    line-height: 60px;\n    margin-top: 20%;\n    user-select: none;\n  }\n\n  .container {\n    margin: 0 auto;\n    padding: 20px 20px 30px 20px;\n    width: 1200px;\n    height: calc(100vh - 210px);\n    background-color: #fff;\n    box-shadow: 0 0 20px 5px rgba(0, 0, 0, 0.1);\n\n    .tips {\n      width: calc(100% - 20px);\n      margin: 0 auto;\n      border-radius: 10px;\n      background-color: rgba(0, 0, 0, 0.1);\n      text-align: left;\n      padding: 10px;\n      line-height: 1.5;\n      font-size: 12px;\n      position: relative;\n\n      .tips-close {\n        position: absolute;\n        right: 15px;\n        top: 5px;\n\n        i {\n          margin-left: 10px;\n          font-size: 15px;\n          cursor: pointer;\n          transition: 0.5s;\n\n          &:hover {\n            color: #f56c6c;\n          }\n        }\n      }\n    }\n\n    .main {\n      .in {\n        margin: 20px 0;\n\n        .model-select {\n          width: 200px;\n        }\n\n        .el-button {\n          width: 100px;\n        }\n      }\n\n      .prompts {\n        max-height: calc(100vh - 350px);\n        overflow-y: auto;\n\n        &::-webkit-scrollbar-thumb {\n          border-radius: 10px;\n          background-color: skyblue;\n          background-image: -webkit-linear-gradient(\n            45deg,\n            rgba(255, 255, 255, 0.2) 25%,\n            transparent 25%,\n            transparent 50%,\n            rgba(255, 255, 255, 0.2) 50%,\n            rgba(255, 255, 255, 0.2) 75%,\n            transparent 75%,\n            transparent\n          );\n        }\n\n        &::-webkit-scrollbar-track {\n          box-shadow: inset 0 0 5px rgb(144, 187, 235);\n          background: #ededed;\n          border-radius: 10px;\n        }\n\n        .prompt,\n        .prompt-load {\n          display: flex;\n          padding: 30px;\n          text-align: left;\n          border-radius: 10px;\n\n          .prompt-avatar {\n            width: 100px;\n\n            img {\n              width: 50px;\n              height: 50px;\n            }\n          }\n\n          .prompt-content {\n            width: calc(100% - 100px);\n            line-height: 2;\n            word-wrap: break-word;\n          }\n        }\n      }\n    }\n  }\n}\n</style>\n  ","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./answer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./answer.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./answer.vue?vue&type=template&id=2a03a6ee&scoped=true&\"\nimport script from \"./answer.vue?vue&type=script&lang=js&\"\nexport * from \"./answer.vue?vue&type=script&lang=js&\"\nimport style0 from \"./answer.vue?vue&type=style&index=0&id=2a03a6ee&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2a03a6ee\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}